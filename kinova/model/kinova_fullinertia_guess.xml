<!-- 
  Kinova Arm Model - CAD-derived Initial Estimates
  
  This model contains inertial parameters estimated from CAD geometry.
  These values are approximate due to:
  - Assumed uniform material densities (actual parts have varying densities)
  - Simplified internal geometry (motors, bearings, cables not fully modeled)
  - Manufacturing tolerances not accounted for
  - Fasteners and small components omitted
  
  Use system identification to refine these parameters against real hardware data.
  Reference: kinova_fullinertia.xml contains the ground truth values.
-->
<mujoco model="Kinova_description">
  <compiler angle="radian" meshdir="meshes" balanceinertia="true"/>

  <visual>
    <global offwidth="1280" offheight="960"/>
  </visual>

  <option timestep="0.001" gravity="0 0 -9.81">
      <flag contact="enable" energy="enable" gravity="enable"/>
  </option>

  <asset>
    <mesh name="base_link" file="base_link.STL"/>
    <mesh name="link1" file="link1.STL"/>
    <mesh name="link2" file="link2.STL"/>
    <mesh name="link3" file="link3.STL"/>
    <mesh name="link4" file="link4.STL"/>
    <mesh name="link5" file="link5.STL"/>
    <mesh name="link6" file="link6.STL"/>
    <mesh name="link7" file="link7.STL"/>
    <mesh name="link_tool" file="link_tool.STL"/>

    <texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0 0 0" width="512"
        height="3072"/>
    <!-- Marble floor texture -->
    <texture type="2d" name="marble" builtin="flat" rgb1="0.95 0.93 0.9" rgb2="0.85 0.82 0.78" 
        mark="random" markrgb="0.7 0.68 0.65" width="512" height="512"/>
    <material name="marblefloor" texture="marble" texuniform="true" texrepeat="4 4"
        reflectance="0.4" specular="0.6" shininess="0.8"/>
    <!-- Table material -->
    <material name="table_wood" rgba="0.55 0.35 0.2 1" specular="0.2" shininess="0.05"/>
  </asset>

  <worldbody>
    <light pos="0 0 1.5" dir="0 0 -1" directional="true"/>
    <geom name="floor" size="0 0 0.05" type="plane" material="marblefloor"/>
    
    <geom type="mesh" rgba="0.79216 0.81961 0.93333 1" mesh="base_link"/>
    <!-- CAD-derived inertial estimates - approximate values requiring system ID refinement -->
    <body name="link1" pos="0 0 0.14045" quat="0.707105 -0.707108 0 0">
      <!-- CAD estimate: assumed uniform aluminum density, simplified internal geometry -->
      <inertial pos="5.8e-05 -0.092 0.0051" mass="0.33" fullinertia="1.68e-04 1.85e-04 2.32e-04 -2.5e-09 0 0"/>
      <joint name="joint1" pos="0 0 0" axis="0 -1 0" range="-3.14 3.14" actuatorfrcrange="-30 30"/>
      <site name="joint1" pos="0 0 0" size="0.001"/>
      <geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link1"/>
      <site name="frame1_x" type="cylinder" pos="0.03 0 0" size="0.003 0.03" rgba="1 0 0 0.8" euler="0 1.5708 0"/>
      <site name="frame1_y" type="cylinder" pos="0 0.03 0" size="0.003 0.03" rgba="0 1 0 0.8" euler="1.5708 0 0"/>
      <site name="frame1_z" type="cylinder" pos="0 0 0.03" size="0.003 0.03" rgba="0 0 1 0.8"/>
      <body name="link2" pos="0 -0.1434 0" quat="0.707105 0.707108 0 0">
        <!-- CAD estimate: motor mass distribution approximated -->
        <inertial pos="7.1e-05 -0.019 0.092" mass="0.48" fullinertia="5.52e-04 7.66e-04 4.24e-04 1.3e-08 1.8e-08 -7.02e-05"/>
        <joint name="joint2" pos="0 0 0" axis="0 -1 0" range="-3.14 3.14" actuatorfrcrange="-40 40"/>
        <site name="joint2" pos="0 0 0" size="0.001"/>
        <geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link2"/>
        <site name="frame2_x" type="cylinder" pos="0.03 0 0" size="0.003 0.03" rgba="1 0 0 0.8" euler="0 1.5708 0"/>
        <site name="frame2_y" type="cylinder" pos="0 0.03 0" size="0.003 0.03" rgba="0 1 0 0.8" euler="1.5708 0 0"/>
        <site name="frame2_z" type="cylinder" pos="0 0 0.03" size="0.003 0.03" rgba="0 0 1 0.8"/>
        <body name="link3" pos="6.1995e-05 -0.010643 0.1956" quat="0.707105 -0.707108 0 0">
          <!-- CAD estimate: cable routing mass not included -->
          <inertial pos="-5.2e-06 -0.124 0.0072" mass="0.41" fullinertia="1.09e-03 4.24e-04 1.16e-03 2.8e-08 -6.2e-09 8.66e-05"/>
          <joint name="joint3" pos="0 0 0" axis="0 -1 0" range="-3.14 3.14" actuatorfrcrange="-30 30"/>
          <site name="joint3" pos="0 0 0" size="0.001"/>
          <geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link3"/>
          <site name="frame3_x" type="cylinder" pos="0.03 0 0" size="0.003 0.03" rgba="1 0 0 0.8" euler="0 1.5708 0"/>
          <site name="frame3_y" type="cylinder" pos="0 0.03 0" size="0.003 0.03" rgba="0 1 0 0.8" euler="1.5708 0 0"/>
          <site name="frame3_z" type="cylinder" pos="0 0 0.03" size="0.003 0.03" rgba="0 0 1 0.8"/>
          <body name="link4" pos="0 -0.2242 -0.0202" quat="0.707105 0.707108 0 0">
            <!-- CAD estimate: bearing assemblies simplified -->
            <inertial pos="2.5e-07 0.00019 0.071" mass="0.38" fullinertia="5.45e-04 5.16e-04 2.51e-04 5.1e-09 -3.3e-08 -6.35e-05"/>
            <joint name="joint4" pos="0 0 0" axis="0 -1 0" range="-3.14 3.14" actuatorfrcrange="-30 30"/>
            <site name="joint4" pos="0 0 0" size="0.001"/>
            <geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link4"/>
            <site name="frame4_x" type="cylinder" pos="0.03 0 0" size="0.003 0.03" rgba="1 0 0 0.8" euler="0 1.5708 0"/>
            <site name="frame4_y" type="cylinder" pos="0 0.03 0" size="0.003 0.03" rgba="0 1 0 0.8" euler="1.5708 0 0"/>
            <site name="frame4_z" type="cylinder" pos="0 0 0.03" size="0.003 0.03" rgba="0 0 1 0.8"/>
            <body name="link5" pos="0 0.0084 0.2203" quat="0.707105 -0.707108 0 0">
              <!-- CAD estimate: wrist actuator mass approximated -->
              <inertial pos="-1.2e-07 -0.047 0.0098" mass="0.27" fullinertia="2.19e-04 1.21e-04 2.38e-04 4.7e-10 3.1e-09 2.43e-05"/>
              <joint name="joint5" pos="0 0 0" axis="0 -1 0" range="-3.14 3.14" actuatorfrcrange="-9 9"/>
              <site name="joint5" pos="0 0 0" size="0.001"/>
              <geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link5"/>
              <site name="frame5_x" type="cylinder" pos="0.03 0 0" size="0.003 0.03" rgba="1 0 0 0.8" euler="0 1.5708 0"/>
              <site name="frame5_y" type="cylinder" pos="0 0.03 0" size="0.003 0.03" rgba="0 1 0 0.8" euler="1.5708 0 0"/>
              <site name="frame5_z" type="cylinder" pos="0 0 0.03" size="0.003 0.03" rgba="0 0 1 0.8"/>
              <body name="link6" pos="0 -0.0931 -0.01205" quat="0.707105 0.707108 0 0">
                <!-- CAD estimate: encoder housing simplified -->
                <inertial pos="-8.5e-08 0.0038 0.0485" mass="0.23" fullinertia="2.34e-04 2.03e-04 1.52e-04 -1.9e-09 2.2e-09 -3.32e-05"/>
                <joint name="joint6" pos="0 0 0" axis="0 -1 0" range="-3.14 3.14" actuatorfrcrange="-9 9"/>
                <site name="joint6" pos="0 0 0" size="0.001"/>
                <geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link6"/>
                <site name="frame6_x" type="cylinder" pos="0.03 0 0" size="0.003 0.03" rgba="1 0 0 0.8" euler="0 1.5708 0"/>
                <site name="frame6_y" type="cylinder" pos="0 0.03 0" size="0.003 0.03" rgba="0 1 0 0.8" euler="1.5708 0 0"/>
                <site name="frame6_z" type="cylinder" pos="0 0 0.03" size="0.003 0.03" rgba="0 0 1 0.8"/>
                <body name="link7" pos="0 0.01265 0.1178" quat="0.707105 -0.707108 0 0">
                  <!-- CAD estimate: end-effector mounting plate and gripper interface approximated -->
                  <inertial pos="-9.2e-05 -0.079 0.0029" mass="0.58" fullinertia="1.29e-03 3.13e-04 1.63e-03 5.5e-07 1.5e-07 -1.09e-04"/>
                  <joint name="joint7" pos="0 0 0" axis="0 -1 0" range="-3.14 3.14" actuatorfrcrange="-9 9"/>
                  <site name="joint7" pos="0 0 0" size="0.001"/>
                  <geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link7"/>
                  <site name="frame7_x" type="cylinder" pos="0.03 0 0" size="0.003 0.03" rgba="1 0 0 0.8" euler="0 1.5708 0"/>
                  <site name="frame7_y" type="cylinder" pos="0 0.03 0" size="0.003 0.03" rgba="0 1 0 0.8" euler="1.5708 0 0"/>
                  <site name="frame7_z" type="cylinder" pos="0 0 0.03" size="0.003 0.03" rgba="0 0 1 0.8"/>
                  <geom pos="0 -0.26156 0" quat="1 0 0 0" type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="link_tool"/>
                  <!-- Frame axes at end-effector: Red=X, Green=Y, Blue=Z -->
                  <site name="ee_x" type="cylinder" pos="0.05 -0.26 0" size="0.005 0.05" rgba="1 0 0 1" euler="0 1.57 0"/>
                  <site name="ee_y" type="cylinder" pos="0 -0.21 0" size="0.005 0.05" rgba="0 1 0 1" euler="1.57 0 0"/>
                  <site name="ee_z" type="cylinder" pos="0 -0.26 0.05" size="0.005 0.05" rgba="0 0 1 1"/>
                  <camera name="wrist_cam" pos="0 0 0.15" xyaxes="-1 0 0 0 0 1" fovy="120"/>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
    </body>
  </worldbody>

  <actuator>
        <motor name="a1" ctrllimited="true" ctrlrange="-36.0 36.0"  joint="joint1"/>
        <motor name="a2" ctrllimited="true" ctrlrange="-36.0 36.0"  joint="joint2"/>
        <motor name="a3" ctrllimited="true" ctrlrange="-36.0 36.0"  joint="joint3"/>
        <motor name="a4" ctrllimited="true" ctrlrange="-36.0 36.0"  joint="joint4"/>
        <motor name="a5" ctrllimited="true" ctrlrange="-9.8 9.8"  joint="joint5"/>
        <motor name="a6" ctrllimited="true" ctrlrange="-9.8 9.8"  joint="joint6"/>
        <motor name="a7" ctrllimited="true" ctrlrange="-9.8 9.8"  joint="joint7"/>
  </actuator>

</mujoco>
